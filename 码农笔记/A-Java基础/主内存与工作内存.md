---
layout: post
title: 主内存与工作内存
subtitle: 
author: ezekielgcl
date: 2023-08-08
aliases: 
tags: 
keyword: 码农笔记
catalog: true
category: 码农笔记
status: 
link: 
BeginDate: 2023-08-08
EndDate: 
header-img: img/post-bg-re-vs-ng2.jpg
banner: "![[code6.jpeg]]"
banner_y: 0.40239
banner_icon: 📚
---

# 内存模型参考
[[Java内存区域和内存模型（JMM）]]

# 主内存与工作内存：

## **计算机高速缓存和缓存一致性**

计算机在高速的 CPU 和相对低速的存储设备之间使用高速缓存，作为内存和处理器之间的缓冲。将运算需要使用到的数据复制到缓存中，让运算能快速运行，当运算结束后再从缓存同步回内存之中。

在多处理器的系统中(或者单处理器多核的系统)，每个处理器内核都有自己的高速缓存，它们有共享同一主内存(Main Memory)。

当多个处理器的运算任务都涉及同一块主内存区域时，将可能导致各自的缓存数据不一致。

为此，需要各个处理器访问缓存时都遵循一些协议，在读写时要根据协议进行操作，来维护缓存的一致性。
![image.png](https://raw.githubusercontent.com/guchaolong/articleImgs/master/20230808043716.png)

## JVM主内存与工作内存

Java 内存模型的主要目标是定义程序中各个变量的访问规则，即在虚拟机中将变量（线程共享的变量）存储到内存和从内存中取出变量这样底层细节。

Java内存模型中规定了所有的变量都存储在主内存中，每条线程还有自己的工作内存，线程对变量的所有操作都必须在工作内存中进行，而不能直接读写主内存中的变量。

这里的工作内存是 JMM 的一个抽象概念，也叫本地内存，其存储了该线程以读 / 写共享变量的副本。

![image.png](https://raw.githubusercontent.com/guchaolong/articleImgs/master/20230808043832.png)

这里所讲的主内存、工作内存与 Java 内存区域中的 Java 堆、栈、方法区等并不是同一个层次的内存划分，这两者基本上是没有关系的，如果两者一定要勉强对应起来，那从变量、主内存、工作内存的定义来看
**主内存主要包括本地方法区和堆**。
每个线程都有一个工作内存，工作内存中主要包括**两个部分**，一个是属于**该线程私有的栈**和**对主存部分变量拷贝的寄存器**(包括程序计数器PC和cup工作的高速缓存区)**。**
